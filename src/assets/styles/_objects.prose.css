/* ==========================================================================
   #PROSE
   ========================================================================== */

/**
 * Prose is a scope for linear text.
 */

.o-prose {
    --space: var(--s3);
    --flow-inset: 1.5em;
    --list-display: list-item;
    --anchor-decoration: underline;
    font-size: var(--font-size-body);
    font-weight: var(--font-weight-body, inherit);
}

/* -------------------------------------
   #SPACES
   ------------------------------------- */

/**
 * Vertical space (flow direction)
 */

.o-prose > * {
    margin-block-end: 0;
    margin-block-start: 0;
}

.o-prose > * + * {
    margin-block-start: var(--space);
}

/**
 * Exceptions
 *
 * 1. Space after h2
 * 2. Space after h3
 * 3. Space after h4, h5 and h6
 * 4. Space between li
 * 5. Space between an ul inside a li
 */

.o-prose > h2 + * {
    --space: var(--s-1); /* [1] */
}

.o-prose > h3 + * {
    --space: var(--s-1); /* [2] */
}

.o-prose :matches(h4, h5, h6) + * {
    --space: 0; /* [3] */
}

.o-prose > ul li {
    --space: var(--s-3); /* [4] */
}

.o-prose > ul ul {
    margin-block-start: var(--space); /* [5] */
}

.o-prose > p + p {
    --space: var(--s-1);
}



/**
 * Blockquote
 */

.o-prose > blockquote > * {
    margin-block-end: 0;
    margin-block-start: 0;
}

.o-prose > blockquote > * + * {
    margin-block-start: var(--space);
}

.o-prose > blockquote > p + p {
    --space: var(--s-1);
}



/**
 * Horizontal space (writing direction)
 *
 *  1. Images are not included because because they are fluid by default
 *     (`max-width: 100%;`). This is defined in the element style. And we do not
 *     want to override it.
 */

.o-prose *:not(img) {
    max-inline-size: var(--line-measure); /* [1] */
}

/* -------------------------------------
   #STYLES
   ------------------------------------- */

/**
 * Paragraphs
 */

.o-prose > p {
    line-height: var(--line-height-loose);
    hyphenate-limit-chars: 6 3 2;
    hyphenate-limit-last: always;
    hyphenate-limite-lines: 2;
    hyphenate-limite-zone: 8%;
    hyphens: auto;
}



/**
 * Headings
 */

.o-prose > h1 {
    @extend %title;
}

.o-prose > h2 {
    @extend %heading;
}

.o-prose > h3 {
    @extend %subhead;
}

.o-prose :matches(h4, h5, h6) {
    @extend %overline;
}




/**
 * Lists
 */

.o-prose :--list {
    padding-inline-start: 0;
}

.o-prose :--list :--list {
    padding-inline-start: var(--flow-inset);
}



.o-prose dt {
    font-weight: 800;
}

.o-prose dd {
    margin-inline-start: var(--flow-inset, 0);
}

/**
 * 1. `dt` are sometimes visually hidden. This rules force consistency
 */
.o-prose dd + .o-prose dt,
.o-prose dd + .o-prose dt.u-visually-hidden + .o-prose dd { /* [1] */
    margin-block-start: calc(var(--flow-space, 0) / 2);
}


/* -------------------------------------
   #EMBED
   ------------------------------------- */

.o-prose figcaption {
    @extend %caption;
}
